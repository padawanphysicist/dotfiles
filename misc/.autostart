#!/usr/bin/env bash
#
# Autostart script
#
# This script should be run during the initialization of the
# window/desktop manager.
#
# You should be careful for using this in the startupHook of Xmonad,
# since it runs each time xmonad is restarted.
#

function run {
  PROGRAM_NAME=$1
  COMMAND=${PROGRAM_NAME}

  if [ ! -z "$2" ]; then COMMAND=$2; fi

  pgrep --full ${PROGRAM_NAME} 2>&1 > /dev/null
  if [[ "$?" == 1 ]]; then # $PROGRAM_NAME not running
    ${COMMAND} &
  fi
}

[[ -f ~/.Xresources_custom ]] && xrdb -merge ~/.Xresources_custom
xsetroot -cursor_name left_ptr &
setxkbmap -layout br -option -option altwin:meta_alt -option caps:escape &

run dunst
run stalonetray
run redshift
run xscreensaver 'xscreensaver -no-splash'
run odrive '/opt/OpenDrive/odrive'
run dropbox '/home/santos/.local/bin/dropbox start'

systemctl is-active --quiet --user tmux --quiet || systemctl --user restart tmux
systemctl is-active --quiet --user emacs --quiet || systemctl --user restart emacs
